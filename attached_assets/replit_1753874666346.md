# Voice AI Chat Application

## Overview

This is a full-stack voice-enabled AI chat application built with React, Express, and PostgreSQL. The app allows users to have conversations with AI through both text and voice inputs, featuring real-time audio recording, transcription, and AI response generation using Google's Gemini AI or Groq's Llama 8B model. Users can save their API keys directly in the UI for easy configuration.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

The application follows a modern full-stack architecture with clear separation between client and server:

- **Frontend**: React with TypeScript, using Vite for build tooling
- **Backend**: Express.js server with TypeScript
- **Database**: PostgreSQL with Drizzle ORM
- **AI Integration**: Google Gemini AI and Groq (Llama 8B) for text processing and audio transcription
- **UI Framework**: shadcn/ui components with Tailwind CSS
- **State Management**: TanStack Query for server state management

## Key Components

### Frontend Architecture
- **Component Structure**: Organized using shadcn/ui design system with custom components
- **Routing**: Wouter for lightweight client-side routing
- **State Management**: TanStack Query for API calls and caching
- **Audio Recording**: Custom hook (`useAudioRecorder`) for handling voice input
- **Styling**: Tailwind CSS with CSS variables for theming

### Backend Architecture
- **API Routes**: RESTful endpoints for conversations, messages, and settings
- **Storage Layer**: Abstracted storage interface with in-memory implementation (ready for database integration)
- **AI Services**: Modular service layer for Gemini AI integration
- **File Handling**: Multer for audio file uploads

### Database Schema
The application uses three main entities:
- **Conversations**: Track individual chat sessions
- **Messages**: Store user and AI messages with optional audio URLs
- **Settings**: User preferences for AI provider, audio quality, voice settings, and API keys storage

## Data Flow

1. **Voice Input**: User records audio through browser MediaRecorder API
2. **Audio Processing**: Audio is uploaded to server and transcribed using either Gemini or Groq Whisper
3. **AI Processing**: Transcribed text is sent to either Gemini or Groq Llama 8B for response generation
4. **Storage**: Messages are stored with conversation context
5. **Real-time Updates**: UI updates through TanStack Query cache invalidation

## Recent Changes

- **January 30, 2025**: Added multiple Groq model support (Llama 3.3 70B, Llama 3.1 8B, Gemma 2 9B) with model selection in settings
- **January 30, 2025**: Implemented NSFW mode with specialized girlfriend persona and reduced content filtering
- **January 30, 2025**: Fixed voice message functionality with proper file upload handling and API key integration
- **January 30, 2025**: Added PostgreSQL database integration with proper schema and migrations
- **January 30, 2025**: Replaced in-memory storage with DatabaseStorage class using Drizzle ORM
- **January 30, 2025**: Added Groq support with Llama 8B model for text generation and Whisper for audio transcription
- **January 30, 2025**: Implemented in-app API key management with secure UI input fields
- **January 30, 2025**: Enhanced settings panel with provider selection and API key configuration

## External Dependencies

### Core Dependencies
- **@google/genai**: Google Gemini AI integration
- **@neondatabase/serverless**: Neon database adapter (PostgreSQL)
- **drizzle-orm**: Type-safe ORM for database operations
- **@tanstack/react-query**: Server state management
- **wouter**: Lightweight routing

### UI Dependencies
- **@radix-ui/***: Headless UI components
- **tailwindcss**: Utility-first CSS framework
- **class-variance-authority**: Component variant management
- **lucide-react**: Icon library

### Development Tools
- **vite**: Frontend build tool
- **tsx**: TypeScript execution for development
- **esbuild**: Production bundling for server
- **drizzle-kit**: Database migration tool

## Deployment Strategy

The application is configured for deployment with:
- **Build Process**: Vite builds the client, esbuild bundles the server
- **Environment Variables**: Database URL and Gemini API key required
- **Database Migrations**: Drizzle migrations stored in `/migrations` directory
- **Static Assets**: Client builds to `/dist/public`, served by Express in production

### Development vs Production
- **Development**: Uses Vite dev server with HMR, TSX for server execution
- **Production**: Serves static files from Express, uses compiled JavaScript bundle
- **Database**: Configured for PostgreSQL (Neon) with fallback to in-memory storage during development

The architecture prioritizes type safety, developer experience, and scalability while maintaining a clean separation of concerns between frontend, backend, and external services.